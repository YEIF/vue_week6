"use strict";(self["webpackChunkvue_week6"]=self["webpackChunkvue_week6"]||[]).push([[940],{1530:function(e,t,s){function l(e){return{all:e=e||new Map,on:function(t,s){var l=e.get(t);l?l.push(s):e.set(t,[s])},off:function(t,s){var l=e.get(t);l&&(s?l.splice(l.indexOf(s)>>>0,1):e.set(t,[]))},emit:function(t,s){var l=e.get(t);l&&l.slice().map((function(e){e(s)})),(l=e.get("*"))&&l.slice().map((function(e){e(t,s)}))}}}s.d(t,{Z:function(){return r}});const a=l();var r=a},1940:function(e,t,s){s.r(t),s.d(t,{default:function(){return B}});var l=s(6252),a=s(3577),r=s(9963);const o=(0,l._)("h2",null,"購物車",-1),n={class:"text-end"},i=["disabled"],d={class:"table align-middle"},c=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th"),(0,l._)("th",null,"品名"),(0,l._)("th",{style:{width:"150px"}},"數量/單位"),(0,l._)("th",null,"單價")])],-1),u=["onClick"],m={key:0,class:"fas fa-spinner fa-pulse"},p=(0,l.Uk)(" x "),h={class:"input-group input-group-sm"},f={class:"input-group mb-3"},_=["onUpdate:modelValue","onBlur"],b={class:"input-group-text",id:"basic-addon2"},g={class:"text-end"},v=(0,l._)("td",{colspan:"3",class:"text-end"},"總計",-1),y={class:"text-end"},C=(0,l._)("tr",null,null,-1),k={class:"my-5 row justify-content-center"},w={class:"mb-3"},x=(0,l._)("label",{for:"email",class:"form-label"},"Email",-1),V={class:"mb-3"},q=(0,l._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),W={class:"mb-3"},U=(0,l._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),$={class:"mb-3"},I=(0,l._)("label",{for:"address",class:"form-label"},"收件人地址",-1),L={class:"mb-3"},z=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),D={class:"text-end"},O=["disabled"];function Z(e,t,s,Z,A,E){const F=(0,l.up)("VField"),j=(0,l.up)("ErrorMessage"),B=(0,l.up)("VForm");return(0,l.wg)(),(0,l.iD)(l.HY,null,[o,(0,l._)("div",n,[(0,l._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...e)=>E.delAllCarts&&E.delAllCarts(...e)),disabled:0===A.carts.carts?.length},"清空購物車",8,i)]),(0,l._)("table",d,[c,(0,l._)("tbody",null,[A.carts.carts?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(A.carts.carts,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id+"123"},[(0,l._)("td",null,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>E.delCart(e.id)},[A.isLoadingItem===e.id?((0,l.wg)(),(0,l.iD)("i",m)):(0,l.kq)("",!0),p],8,u)]),(0,l._)("td",null,(0,a.zw)(e.product.title),1),(0,l._)("td",null,[(0,l._)("div",h,[(0,l._)("div",f,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t=>e.qty=t,min:"1",type:"number",class:"form-control",onBlur:t=>E.updateCart(e)},null,40,_),[[r.nr,e.qty,void 0,{number:!0}]]),(0,l._)("span",b,(0,a.zw)(e.product.unit),1)])])]),(0,l._)("td",g,(0,a.zw)(e.product.price*e.qty),1)])))),128)):(0,l.kq)("",!0)]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[v,(0,l._)("td",y,(0,a.zw)(A.carts.final_total),1)]),C])]),(0,l._)("div",k,[(0,l.Wm)(B,{ref:"form",class:"col-md-6",onSubmit:E.sendOrder},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",w,[x,(0,l.Wm)(F,{id:"email",name:"email",type:"email",class:(0,a.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:A.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>A.form.user.email=e)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",V,[q,(0,l.Wm)(F,{id:"name",name:"姓名",type:"text",class:(0,a.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:A.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>A.form.user.name=e)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",W,[U,(0,l.Wm)(F,{id:"tel",name:"電話",type:"tel",class:(0,a.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:"required|min:8|max:10|numeric",modelValue:A.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>A.form.user.tel=e)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",$,[I,(0,l.Wm)(F,{id:"address",name:"地址",type:"text",class:(0,a.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:A.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>A.form.user.address=e)},null,8,["class","modelValue"]),(0,l.Wm)(j,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",L,[z,(0,l.wy)((0,l._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=e=>A.form.user.message=e)},null,512),[[r.nr,A.form.user.message]])]),(0,l._)("div",D,[(0,l._)("button",{type:"submit",class:"btn btn-danger",disabled:Object.keys(e).length>0||0===A.carts.carts?.length},"送出訂單",8,O)])])),_:1},8,["onSubmit"])])],64)}var A=s(1530),E={data(){return{carts:{},isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:"",message:""}}}},methods:{getCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/clothes/cart/";this.$http.get(e).then((e=>{this.carts=e.data.data})).catch((e=>{console.dir(e)}))},delCart(e){this.isLoadingItem=e;const t=`https://vue3-course-api.hexschool.io/v2/api/clothes/cart/${e}`;this.$http.delete(t).then((e=>{this.isLoadingItem="",this.getCarts(),A.Z.emit("get-cart-num")})).catch((e=>{console.dir(e)}))},delAllCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/clothes/carts";this.$http.delete(e).then((e=>{this.getCarts(),A.Z.emit("get-cart-num")})).catch((e=>{console.dir(e)}))},updateCart(e){this.isLoadingItem=e.id;const t=`https://vue3-course-api.hexschool.io/v2/api/clothes/cart/${e.id}`,s={product_id:e.product_id,qty:e.qty};this.$http.put(t,{data:s}).then((e=>{this.isLoadingItem="",this.getCarts()})).catch((e=>{console.dir(e)}))},sendOrder(){const e="https://vue3-course-api.hexschool.io/v2/api/clothes/order",t=this.form;this.$http.post(e,{data:t}).then((e=>{alert(e.data.message),this.$refs.form.resetForm(),this.form.user.message="",this.getCarts()})).catch((e=>{console.dir(e),alert(e.response.data.message)}))}},mounted(){this.getCarts()}},F=s(3744);const j=(0,F.Z)(E,[["render",Z]]);var B=j}}]);
//# sourceMappingURL=940.d79ca1b3.js.map